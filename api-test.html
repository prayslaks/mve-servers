<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MVE API Tester</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { color: #333; margin-bottom: 20px; }

        /* Tabs */
        .tabs { display: flex; gap: 5px; margin-bottom: 20px; border-bottom: 2px solid #ddd; }
        .tab { padding: 12px 24px; background: #f0f0f0; border: none; cursor: pointer; font-size: 14px; font-weight: 500; color: #666; border-radius: 8px 8px 0 0; transition: all 0.3s; }
        .tab:hover { background: #e0e0e0; }
        .tab.active { background: white; color: #4CAF50; border-bottom: 2px solid #4CAF50; margin-bottom: -2px; }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .section { background: white; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .section h2 { margin-top: 0; color: #444; border-bottom: 2px solid #4CAF50; padding-bottom: 10px; }
        .api-group { margin-bottom: 15px; padding: 15px; background: #f9f9f9; border-radius: 4px; }
        .api-group h3 { margin: 0 0 10px 0; font-size: 14px; color: #666; }
        .input-group { margin-bottom: 10px; }
        .input-group label { display: block; font-size: 12px; color: #666; margin-bottom: 4px; }
        .input-group input, .input-group textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
        .input-group textarea { height: 80px; resize: vertical; }
        button { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; margin-right: 5px; margin-bottom: 5px; }
        .btn-primary { background: #4CAF50; color: white; }
        .btn-secondary { background: #2196F3; color: white; }
        .btn-danger { background: #f44336; color: white; }
        .btn-warning { background: #ff9800; color: white; }
        button:hover { opacity: 0.9; }
        .response { margin-top: 10px; padding: 10px; background: #263238; color: #aed581; border-radius: 4px; font-family: monospace; font-size: 12px; white-space: pre-wrap; max-height: 300px; overflow-y: auto; }
        .token-display { background: #fff3e0; padding: 10px; border-radius: 4px; margin-bottom: 15px; word-break: break-all; font-size: 12px; }
        .status { padding: 4px 8px; border-radius: 4px; font-size: 12px; margin-left: 10px; }
        .status-success { background: #c8e6c9; color: #2e7d32; }
        .status-error { background: #ffcdd2; color: #c62828; }
        .flex { display: flex; gap: 10px; }
        .flex > * { flex: 1; }
        .server-config { display: flex; gap: 10px; margin-bottom: 15px; }
        .server-config input { flex: 1; }
        .example-box {
            background: #e8f5e9;
            padding: 8px 12px;
            border-radius: 4px;
            margin-top: 5px;
            font-family: monospace;
            font-size: 12px;
            cursor: pointer;
            border: 1px solid #a5d6a7;
            position: relative;
        }
        .example-box:hover {
            background: #c8e6c9;
        }
        .example-box::before {
            content: 'üìã Click to copy: ';
            color: #2e7d32;
            font-weight: bold;
        }
        .example-box.copied::after {
            content: '‚úì Copied!';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: #2e7d32;
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 11px;
            animation: fadeOut 2s forwards;
        }
        @keyframes fadeOut {
            0%, 50% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>MVE API Tester</h1>

        <!-- ÏÑúÎ≤Ñ Íµ¨ÏÑ± -->
        <div class="section">
            <h2>Server Configuration</h2>
            <div class="server-config">
                <div class="input-group" style="margin-bottom: 0;">
                    <label>Login Server URL</label>
                    <input type="text" id="loginServerUrl" value="http://localhost:3000">
                </div>
                <div class="input-group" style="margin-bottom: 0;">
                    <label>Resource Server URL</label>
                    <input type="text" id="resourceServerUrl" value="http://localhost:3001">
                </div>
            </div>
            <div class="token-display">
                <strong>Current JWT Token:</strong><br>
                <span id="currentToken">No token</span>
            </div>
        </div>

        <!-- ÌÉ≠ -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('health')">Ìó¨Ïä§ Ï≤¥ÌÅ¨</button>
            <button class="tab" onclick="switchTab('auth')">Ïù∏Ï¶ù</button>
            <button class="tab" onclick="switchTab('audio')">ÏùåÏõê</button>
            <button class="tab" onclick="switchTab('ai-model')">AI 3D Î™®Îç∏ ÏÉùÏÑ±</button>
            <button class="tab" onclick="switchTab('model-manage')">Ïï°ÏÑ∏ÏÑúÎ¶¨ Î™®Îç∏ Í¥ÄÎ¶¨</button>
            <button class="tab" onclick="switchTab('studio-concert')">Ïä§ÌäúÎîîÏò§ ÏΩòÏÑúÌä∏ ÏÑ∏ÏÖò</button>
            <button class="tab" onclick="switchTab('audience-concert')">Ïò§ÎîîÏñ∏Ïä§ ÏΩòÏÑúÌä∏ ÏÑ∏ÏÖò</button>
        </div>

        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏†: Ìó¨Ïä§ Ï≤¥ÌÅ¨-->
        <div id="tab-health" class="tab-content active">
            <div class="section">
                <h2>Ìó¨Ïä§ Ï≤¥ÌÅ¨ API</h2>

                <!-- Î°úÍ∑∏Ïù∏ ÏÑúÎ≤Ñ Ìó¨Ïä§ Ï≤¥ÌÅ¨ -->
                <div class="api-group">
                    <h3>GET /health/login - Health Check</h3>
                    <button class="btn-primary" onclick="testLoginHealth()">Test Health</button>
                    <div class="response" id="healthResponse"></div>
                </div>

                <!-- Î¶¨ÏÜåÏä§ ÏÑúÎ≤Ñ Ìó¨Ïä§ Ï≤¥ÌÅ¨ -->
                <div class="api-group">
                    <h3>GET /health/resource - Health Check</h3>
                    <button class="btn-primary" onclick="testResourceHealth()">Test Health</button>
                    <div class="response" id="resourceHealthResponse"></div>
                </div>
            </div>
        </div>

        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏†: Ïù∏Ï¶ù -->
        <div id="tab-auth" class="tab-content">
            <div class="section">
                <h2>Ïù∏Ï¶ù API</h2>

                <!-- Ïù¥Î©îÏùº ÌôïÏù∏ -->
                <div class="api-group">
                    <h3>POST /api/auth/check-email - Check Email Availability</h3>
                    <div class="input-group">
                        <label>Email</label>
                        <input type="email" id="checkEmail" placeholder="test@example.com">
                    </div>
                    <button class="btn-primary" onclick="checkEmail()">Check Email</button>
                    <div class="response" id="checkEmailResponse"></div>
                </div>

                <!-- Ïù∏Ï¶ù Î≤àÌò∏ Î©îÏùº Î∞úÏÜ° -->
                <div class="api-group">
                    <h3>POST /api/auth/send-verification - Send Verification Code</h3>
                    <div class="input-group">
                        <label>Email</label>
                        <input type="email" id="verifyEmail" placeholder="test@example.com">
                    </div>
                    <button class="btn-warning" onclick="sendVerification()">Send Code</button>
                    <div class="response" id="sendVerificationResponse"></div>
                </div>

                <!-- Ïù∏Ï¶ù Î≤àÌò∏ -->
                <div class="api-group">
                    <h3>POST /api/auth/verify-code - Verify Code</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Email</label>
                            <input type="email" id="verifyCodeEmail" placeholder="test@example.com">
                        </div>
                        <div class="input-group">
                            <label>Code (6 digits)</label>
                            <input type="text" id="verifyCode" placeholder="123456">
                        </div>
                    </div>
                    <button class="btn-primary" onclick="verifyCode()">Verify Code</button>
                    <div class="response" id="verifyCodeResponse"></div>
                </div>

                <!-- ÌöåÏõêÍ∞ÄÏûÖ -->
                <div class="api-group">
                    <h3>POST /api/auth/signup - Sign Up (Requires Verified Email)</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Email (must be verified)</label>
                            <input type="email" id="signupEmail" placeholder="test@example.com">
                        </div>
                        <div class="input-group">
                            <label>Verification Code (6 digits)</label>
                            <input type="text" id="signupCode" placeholder="123456">
                        </div>
                        <div class="input-group">
                            <label>Password</label>
                            <input type="password" id="signupPassword" placeholder="password123">
                        </div>
                    </div>
                    <button class="btn-primary" onclick="signup()">Sign Up</button>
                    <div class="response" id="signupResponse"></div>
                </div>

                <!-- Î°úÍ∑∏Ïù∏ -->
                <div class="api-group">
                    <h3>POST /api/auth/login - Login</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Email</label>
                            <input type="email" id="loginEmail" placeholder="test@example.com">
                        </div>
                        <div class="input-group">
                            <label>Password</label>
                            <input type="password" id="loginPassword" placeholder="password123">
                        </div>
                    </div>
                    <button class="btn-secondary" onclick="login()">Login & Save Token</button>
                    <div class="response" id="loginResponse"></div>
                </div>

                <!-- ÌîÑÎ°úÌïÑ -->
                <div class="api-group">
                    <h3>GET /api/auth/profile - Get Profile (JWT Required)</h3>
                    <button class="btn-primary" onclick="getProfile()">Get Profile</button>
                    <div class="response" id="profileResponse"></div>
                </div>

                <!-- Î°úÍ∑∏ÏïÑÏõÉ -->
                <div class="api-group">
                    <h3>POST /api/auth/logout - Logout (JWT Required)</h3>
                    <button class="btn-warning" onclick="logout()">Logout</button>
                    <div class="response" id="logoutResponse"></div>
                </div>

                <!-- ÌöåÏõêÏ≤†Ìöå -->
                <div class="api-group">
                    <h3>DELETE /api/auth/withdraw - Delete Account (JWT Required)</h3>
                    <div class="input-group">
                        <label>Password (ÌòÑÏû¨ ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏)</label>
                        <input type="password" id="withdrawPassword" placeholder="current password">
                    </div>
                    <button class="btn-danger" onclick="withdraw()">Delete Account</button>
                    <div class="response" id="withdrawResponse"></div>
                </div>
            </div>
        </div>

        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏†: ÏùåÏõê -->
        <div id="tab-audio" class="tab-content">
            <div class="section">
                <h2>ÏùåÏõê API</h2>

                <!-- ÏùåÏõê Î™©Î°ù -->
                <div class="api-group">
                    <h3>GET /api/audio/list - Get Audio List (JWT Required)</h3>
                    <button class="btn-primary" onclick="getAudioList()">Get Audio List</button>
                    <div class="response" id="audioListResponse"></div>
                </div>

                <!-- ÏùåÏõê Ï†ïÎ≥¥ -->
                <div class="api-group">
                    <h3>GET /api/audio/:id - Get Audio Info (JWT Required)</h3>
                    <div class="input-group">
                        <label>Audio ID</label>
                        <input type="number" id="audioId" placeholder="Enter Audio ID">
                    </div>
                    <button class="btn-primary" onclick="getAudioInfo()">Get Audio Info</button>
                    <div class="response" id="audioInfoResponse"></div>
                </div>

                <!-- ÏùåÏõê Í≤ÄÏÉâ -->
                <div class="api-group">
                    <h3>GET /api/audio/search/:query - Search Audio (JWT Required)</h3>
                    <div class="input-group">
                        <label>Search Query</label>
                        <input type="text" id="audioSearchQuery" placeholder="song name">
                    </div>
                    <button class="btn-primary" onclick="searchAudio()">Search Audio</button>
                    <div class="response" id="audioSearchResponse"></div>
                </div>

                <!-- ÏùåÏõê ÏóÖÎ°úÎìú -->
                <div class="api-group">
                    <h3>POST /api/audio/upload - Upload Audio (JWT Required)</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Title</label>
                            <input type="text" id="uploadTitle" placeholder="Song Title">
                        </div>
                        <div class="input-group">
                            <label>Artist</label>
                            <input type="text" id="uploadArtist" placeholder="Artist Name">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Audio File (AAC, M4A, MP3, WAV)</label>
                        <input type="file" id="uploadAudioFile" accept=".aac,.m4a,.mp3,.wav">
                    </div>
                    <button class="btn-primary" onclick="uploadAudio()">Upload Audio</button>
                    <div class="response" id="uploadAudioResponse"></div>
                </div>

                <!-- ÏùåÏõê ÌååÏùº ÏÑúÎ≤Ñ Í≤ΩÎ°ú ÌöçÎìù -->
                <div class="api-group">
                    <h3>GET /api/audio/stream/:id - Get Audio Url (JWT Required)</h3>
                    <div class="input-group">
                        <label>Audio ID</label>
                        <input type="number" id="targetAudioId" placeholder="Enter Audio ID">
                    </div>
                    <button class="btn-secondary" onclick="streamAudio()">Get Stream URL</button>
                    <div class="response" id="getAudioUrlResponse"></div>
                </div>

                <!-- ÏùåÏõê Ïä§Ìä∏Î¶¨Î∞ç -->
                <div class="api-group">
                    <h3>GET /api/audio/stream/:id - Stream Audio</h3>
                    <div class="input-group">
                        <label>Audio Url</label>
                        <input type="text" id="targetAudioUrl" placeholder="Enter Audio Url">
                    </div>
                    <button class="btn-secondary" onclick="playAudio()">Stream Audio With URL</button>
                    <div class="response" id="streamAudioResponse"></div>
                </div>

                <!-- Ïò§ÎîîÏò§ ÌîåÎ†àÏù¥Ïñ¥ -->
                <audio id="audioPlayer" controls style="width: 100%; margin-top: 10px; display: block;"></audio>
            </div>
        </div>

        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏†: AI 3D Î™®Îç∏ ÏÉùÏÑ± -->
        <div id="tab-ai-model" class="tab-content">
            <div class="section">
                <h2>AI 3D Î™®Îç∏ ÏÉùÏÑ± API</h2>

                <!-- AI Î™®Îç∏ ÏÉùÏÑ± -->
                <div class="api-group">
                    <h3>POST /api/models/generate - Generate 3D Model from Image (JWT Required)</h3>
                    <div class="input-group">
                        <label>PNG Image File</label>
                        <input type="file" id="generateImageFile" accept=".png">
                    </div>
                    <div class="input-group">
                        <label>Prompt</label>
                        <input type="text" id="generatePrompt" placeholder="a cute cat">
                    </div>
                    <button class="btn-primary" onclick="generateModel()">Generate Model</button>
                    <div class="response" id="generateModelResponse"></div>
                </div>

                <!-- Job ÏÉÅÌÉú Ï°∞Ìöå -->
                <div class="api-group">
                    <h3>GET /api/models/jobs/:job_id - Check Job Status (JWT Required)</h3>
                    <div class="input-group">
                        <label>Job ID</label>
                        <input type="text" id="jobId" placeholder="uuid-from-generate-response">
                    </div>
                    <button class="btn-primary" onclick="checkJobStatus()">Check Status</button>
                    <button class="btn-secondary" onclick="startPolling()">Start Auto-Polling (3s)</button>
                    <button class="btn-warning" onclick="stopPolling()">Stop Polling</button>
                    <div class="response" id="jobStatusResponse"></div>
                </div>

                <!-- Î™®Îç∏ Î¶¨Ïä§Ìä∏ -->
                <div class="api-group">
                    <h3>GET /api/models/list - Get Model List (JWT Required)</h3>
                    <button class="btn-primary" onclick="getModelList()">Get Model List</button>
                    <div class="response" id="modelListResponse"></div>
                </div>

                <!-- Î™®Îç∏ Ï†ïÎ≥¥ -->
                <div class="api-group">
                    <h3>GET /api/models/:id - Get Model Info (JWT Required)</h3>
                    <div class="input-group">
                        <label>Model ID</label>
                        <input type="number" id="aiModelId" placeholder="1">
                    </div>
                    <button class="btn-primary" onclick="getAIModelInfo()">Get Model Info</button>
                    <div class="response" id="aiModelInfoResponse"></div>
                </div>

                <!-- Î™®Îç∏ ÏóÖÎ°úÎìú (ÏàòÎèô) -->
                <div class="api-group">
                    <h3>POST /api/models/upload - Upload Model Manually (JWT Required)</h3>
                    <div class="input-group">
                        <label>Model Name (Optional)</label>
                        <input type="text" id="uploadModelName" placeholder="My Model">
                    </div>
                    <div class="input-group">
                        <label>Model File (.glb, .fbx, etc.)</label>
                        <input type="file" id="uploadModelFile" accept=".glb,.gltf,.fbx,.obj">
                    </div>
                    <div class="input-group">
                        <label>Thumbnail (Optional)</label>
                        <input type="file" id="uploadModelThumbnail" accept=".png,.jpg,.jpeg">
                    </div>
                    <button class="btn-primary" onclick="uploadModel()">Upload Model</button>
                    <div class="response" id="uploadModelResponse"></div>
                </div>

                <!-- Î™®Îç∏ Îã§Ïö¥Î°úÎìú -->
                <div class="api-group">
                    <h3>GET /api/models/:id/download - Download Model (JWT Required)</h3>
                    <div class="input-group">
                        <label>Model ID</label>
                        <input type="number" id="downloadModelId" placeholder="1">
                    </div>
                    <button class="btn-secondary" onclick="downloadModel()">Download Model</button>
                    <div class="response" id="downloadModelResponse"></div>
                </div>

                <!-- Î™®Îç∏ ÏÇ≠Ï†ú -->
                <div class="api-group">
                    <h3>DELETE /api/models/:id - Delete Model (JWT Required)</h3>
                    <div class="input-group">
                        <label>Model ID</label>
                        <input type="number" id="deleteAIModelId" placeholder="1">
                    </div>
                    <button class="btn-danger" onclick="deleteAIModel()">Delete Model</button>
                    <div class="response" id="deleteAIModelResponse"></div>
                </div>
            </div>

            <div class="section">
                <h2>AI ÏÑúÎ≤Ñ Dev API (Í∞úÎ∞úÏö© - Ïù∏Ï¶ù ÏóÜÏùå)</h2>

                <!-- DEV ÏóÖÎ°úÎìú -->
                <div class="api-group">
                    <h3>POST /api/models/dev/upload-from-ai - Dev Upload (NO AUTH)</h3>
                    <div class="input-group">
                        <label>User ID (Optional, default: 1)</label>
                        <input type="number" id="devUserId" placeholder="1" value="1">
                    </div>
                    <div class="input-group">
                        <label>Model Name (Optional)</label>
                        <input type="text" id="devModelName" placeholder="Test Model">
                    </div>
                    <div class="input-group">
                        <label>Model File (.glb, .fbx, etc.)</label>
                        <input type="file" id="devModelFile" accept=".glb,.gltf,.fbx,.obj">
                    </div>
                    <div class="input-group">
                        <label>Thumbnail (Optional)</label>
                        <input type="file" id="devThumbnailFile" accept=".png,.jpg,.jpeg">
                    </div>
                    <button class="btn-warning" onclick="devUploadModel()">Dev Upload (No Auth)</button>
                    <div class="response" id="devUploadResponse"></div>
                </div>
            </div>
        </div>

        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏†: ÏóëÏÑ∏ÏÑúÎ¶¨ Î™®Îç∏ Í¥ÄÎ¶¨ -->
        <div id="tab-model-manage" class="tab-content">
            <div class="section">
                <h2>Ïï°ÏÑ∏ÏÑúÎ¶¨ Î™®Îç∏ Í¥ÄÎ¶¨ API</h2>

                <!-- ÏóëÏÑ∏ÏÑúÎ¶¨ ÌîÑÎ¶¨ÏÖã Î¶¨Ïä§Ìä∏ -->
                <div class="api-group">
                    <h3>GET /api/accessory-presets/list - List Presets (JWT Required)</h3>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" id="includePublicPresets"> Include Public Presets
                        </label>
                    </div>
                    <button class="btn-primary" onclick="listPresets()">List Presets</button>
                    <div class="response" id="listPresetsResponse"></div>
                </div>

                <!-- ÏóëÏÑ∏ÏÑúÎ¶¨ ÌîÑÎ¶¨ÏÖã Ï†ÄÏû• -->
                <div class="api-group">
                    <h3>POST /api/accessory-presets/save - Save Preset (JWT Required)</h3>
                    <div class="input-group">
                        <label>Preset Name</label>
                        <input type="text" id="presetName" placeholder="My Preset">
                    </div>
                    <div class="input-group">
                        <label>Description (Optional)</label>
                        <input type="text" id="presetDescription" placeholder="A cool accessory preset">
                    </div>
                    <div class="input-group">
                        <label>Accessories JSON Array</label>
                        <textarea id="presetAccessoriesJson" placeholder='[{"socketName":"head_socket","relativeLocation":{"x":0,"y":0,"z":10},"relativeRotation":{"pitch":0,"yaw":0,"roll":0},"modelUrl":"/models/hat.glb"}]'></textarea>
                        <div class="example-box" onclick="copyToInput('presetAccessoriesJson', '[{&quot;socketName&quot;:&quot;head_socket&quot;,&quot;relativeLocation&quot;:{&quot;x&quot;:0,&quot;y&quot;:0,&quot;z&quot;:10},&quot;relativeRotation&quot;:{&quot;pitch&quot;:0,&quot;yaw&quot;:0,&quot;roll&quot;:0},&quot;modelUrl&quot;:&quot;/models/hat.glb&quot;}]', this)">[{"socketName":"head_socket","relativeLocation":{"x":0,"y":0,"z":10},"relativeRotation":{"pitch":0,"yaw":0,"roll":0},"modelUrl":"/models/hat.glb"}]</div>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" id="presetIsPublic"> Public Preset
                        </label>
                    </div>
                    <button class="btn-primary" onclick="savePreset()">Save Preset</button>
                    <div class="response" id="savePresetResponse"></div>
                </div>

                <!-- ÏóëÏÑ∏ÏÑúÎ¶¨ ÌîÑÎ¶¨ÏÖã Î°úÎìú -->
                <div class="api-group">
                    <h3>GET /api/accessory-presets/:id - Get Preset (JWT Required)</h3>
                    <div class="input-group">
                        <label>Preset ID</label>
                        <input type="number" id="getPresetId" placeholder="1">
                    </div>
                    <button class="btn-primary" onclick="getPreset()">Get Preset</button>
                    <div class="response" id="getPresetResponse"></div>
                </div>

                <!-- ÏóëÏÑ∏ÏÑúÎ¶¨ ÌîÑÎ¶¨ÏÖã ÏóÖÎç∞Ïù¥Ìä∏ -->
                <div class="api-group">
                    <h3>PUT /api/accessory-presets/:id - Update Preset (JWT Required)</h3>
                    <div class="input-group">
                        <label>Preset ID</label>
                        <input type="number" id="updatePresetId" placeholder="1">
                    </div>
                    <div class="input-group">
                        <label>Preset Name (Optional)</label>
                        <input type="text" id="updatePresetName" placeholder="Updated Preset">
                    </div>
                    <div class="input-group">
                        <label>Description (Optional)</label>
                        <input type="text" id="updatePresetDescription" placeholder="Updated description">
                    </div>
                    <div class="input-group">
                        <label>Accessories JSON Array (Optional)</label>
                        <textarea id="updatePresetAccessoriesJson" placeholder='[{"socketName":"head_socket","relativeLocation":{"x":0,"y":0,"z":10},"relativeRotation":{"pitch":0,"yaw":0,"roll":0},"modelUrl":"/models/hat.glb"}]'></textarea>
                        <div class="example-box" onclick="copyToInput('updatePresetAccessoriesJson', '[{&quot;socketName&quot;:&quot;head_socket&quot;,&quot;relativeLocation&quot;:{&quot;x&quot;:0,&quot;y&quot;:0,&quot;z&quot;:10},&quot;relativeRotation&quot;:{&quot;pitch&quot;:0,&quot;yaw&quot;:0,&quot;roll&quot;:0},&quot;modelUrl&quot;:&quot;/models/hat.glb&quot;}]', this)">[{"socketName":"head_socket","relativeLocation":{"x":0,"y":0,"z":10},"relativeRotation":{"pitch":0,"yaw":0,"roll":0},"modelUrl":"/models/hat.glb"}]</div>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" id="updatePresetIsPublic"> Public Preset
                        </label>
                    </div>
                    <button class="btn-warning" onclick="updatePreset()">Update Preset</button>
                    <div class="response" id="updatePresetResponse"></div>
                </div>

                <!-- ÏóëÏÑ∏ÏÑúÎ¶¨ ÌîÑÎ¶¨ÏÖã ÏÇ≠Ï†ú -->
                <div class="api-group">
                    <h3>DELETE /api/accessory-presets/:id - Delete Preset (JWT Required)</h3>
                    <div class="input-group">
                        <label>Preset ID</label>
                        <input type="number" id="deletePresetId" placeholder="1">
                    </div>
                    <button class="btn-danger" onclick="deletePreset()">Delete Preset</button>
                    <div class="response" id="deletePresetResponse"></div>
                </div>
            </div>
        </div>

        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏†: Ïä§ÌäúÎîîÏò§ ÏΩòÏÑúÌä∏ ÏÑ∏ÏÖò -->
        <div id="tab-studio-concert" class="tab-content">
            <div class="section">
                <h2>Ïä§ÌäúÎîîÏò§ ÏΩòÏÑúÌä∏ ÏÑ∏ÏÖò API</h2>

                <!-- Create Concert -->
                <div class="api-group">
                    <h3>POST /api/concert/create - Create Concert (JWT Required)</h3>
                    <div class="input-group">
                        <label>ÏΩòÏÑúÌä∏ Ïù¥Î¶Ñ</label>
                        <input type="text" id="concertName" placeholder="My First Concert">
                    </div>
                    <div class="input-group">
                        <label>ÏµúÎåÄ Í¥ÄÍ∞ù Ïàò (Optional)</label>
                        <input type="number" id="concertMaxAudience" placeholder="100">
                    </div>
                    <div class="input-group">
                        <label>Songs JSON (Optional)</label>
                        <textarea id="concertSongsJson" placeholder='[{"songNum":1,"audioId":1,"streamUrl":"/api/audio/stream/1","stageDirectionId":10}]'></textarea>
                        <div class="example-box" onclick="copyToInput('concertSongsJson', '[{&quot;songNum&quot;:1,&quot;audioId&quot;:1,&quot;streamUrl&quot;:&quot;/api/audio/stream/1&quot;,&quot;stageDirectionId&quot;:10}]', this)">[{"songNum":1,"audioId":1,"streamUrl":"/api/audio/stream/1","stageDirectionId":10}]</div>
                    </div>
                    <div class="input-group">
                        <label>Accessories JSON (Optional)</label>
                        <textarea id="concertAccessoriesJson" placeholder='[{"socketName":"head_socket","relativeLocation":{"x":0,"y":0,"z":10},"relativeRotation":{"pitch":0,"yaw":0,"roll":0},"modelUrl":"/models/hat.glb"}]'></textarea>
                        <div class="example-box" onclick="copyToInput('concertAccessoriesJson', '[{&quot;socketName&quot;:&quot;head_socket&quot;,&quot;relativeLocation&quot;:{&quot;x&quot;:0,&quot;y&quot;:0,&quot;z&quot;:10},&quot;relativeRotation&quot;:{&quot;pitch&quot;:0,&quot;yaw&quot;:0,&quot;roll&quot;:0},&quot;modelUrl&quot;:&quot;/models/hat.glb&quot;}]', this)">[{"socketName":"head_socket","relativeLocation":{"x":0,"y":0,"z":10},"relativeRotation":{"pitch":0,"yaw":0,"roll":0},"modelUrl":"/models/hat.glb"}]</div>
                    </div>
                    <button class="btn-primary" onclick="createConcert()">Create Concert</button>
                    <div class="response" id="createConcertResponse"></div>
                </div>

                <!-- Update Listen Server -->
                <div class="api-group">
                    <h3>POST /api/concert/:roomId/listen-server - Update Listen Server (JWT Required, Studio Only)</h3>
                    <div class="input-group">
                        <label>Room ID</label>
                        <input type="text" id="listenServerRoomId" placeholder="concert_1234567890_abc123">
                    </div>
                    <div class="flex">
                        <div class="input-group">
                            <label>Local IP (ÌïÑÏàò)</label>
                            <input type="text" id="listenServerLocalIP" placeholder="192.168.0.100">
                        </div>
                        <div class="input-group">
                            <label>Port (ÌïÑÏàò)</label>
                            <input type="number" id="listenServerPort" placeholder="7777">
                        </div>
                    </div>
                    <div class="flex">
                        <div class="input-group">
                            <label>Public IP (ÏÑ†ÌÉù)</label>
                            <input type="text" id="listenServerPublicIP" placeholder="203.0.113.50">
                        </div>
                        <div class="input-group">
                            <label>Public Port (ÏÑ†ÌÉù)</label>
                            <input type="number" id="listenServerPublicPort" placeholder="7777">
                        </div>
                    </div>
                    <button class="btn-primary" onclick="updateListenServer()">Update Listen Server</button>
                    <div class="response" id="updateListenServerResponse"></div>
                </div>

                <!-- Toggle Concert Open -->
                <div class="api-group">
                    <h3>POST /api/concert/:roomId/toggleConcertOpen - Make Client Join Listen Server (JWT Required, Studio Only)</h3>
                    <div class="input-group">
                        <label>Room ID</label>
                        <input type="text" id="toggleConcertOpenRoomId" placeholder="concert_1234567890_abc123">
                    </div>
                    <button class="btn-primary" onclick="toggleConcertOpen(true)">Open Concert</button>
                    <button class="btn-primary" onclick="toggleConcertOpen(false)">Close Concert</button>
                    <div class="response" id="toggleConcertOpenResponse"></div>
                </div>

                <!-- Register Client (Join) -->
                <div class="api-group">
                    <h3>POST /api/concert/:roomId/join - Register Client (JWT Required, Studio Only)</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Room ID</label>
                            <input type="text" id="joinRoomIdStudio" placeholder="concert_1234567890_abc123">
                        </div>
                        <div class="input-group">
                            <label>Client User ID</label>
                            <input type="number" id="joinClientId" placeholder="2">
                        </div>
                    </div>
                    <button class="btn-secondary" onclick="joinConcert()">Register Client</button>
                    <div class="response" id="joinConcertResponse"></div>
                </div>

                <!-- Unregister Client (Leave) -->
                <div class="api-group">
                    <h3>POST /api/concert/:roomId/leave - Unregister Client (JWT Required, Studio Only)</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Room ID</label>
                            <input type="text" id="leaveRoomId" placeholder="concert_1234567890_abc123">
                        </div>
                        <div class="input-group">
                            <label>Client User ID</label>
                            <input type="number" id="leaveClientId" placeholder="2">
                        </div>
                    </div>
                    <button class="btn-danger" onclick="leaveConcert()">Unregister Client</button>
                    <div class="response" id="leaveConcertResponse"></div>
                </div>

                <!-- Add Song -->
                <div class="api-group">
                    <h3>POST /api/concert/:roomId/songs/add - Add Song (JWT Required, Studio Only)</h3>
                    <div class="input-group">
                        <label>Room ID</label>
                        <input type="text" id="addSongRoomId" placeholder="concert_1234567890_abc123">
                    </div>
                    <div class="flex">
                        <div class="input-group">
                            <label>Song Number</label>
                            <input type="number" id="addSongNum" placeholder="1">
                        </div>
                        <div class="input-group">
                            <label>Audio ID</label>
                            <input type="number" id="addSongAudioId" placeholder="1">
                        </div>
                    </div>
                    <div class="flex">
                        <div class="input-group">
                            <label>Stream URL</label>
                            <input type="text" id="addSongStreamUrl" placeholder="/api/audio/stream/1">
                        </div>
                        <div class="input-group">
                            <label>Stage Direction ID</label>
                            <input type="number" id="addSongStageDirectionId" placeholder="10">
                        </div>
                    </div>
                    <button class="btn-primary" onclick="addSong()">Add Song</button>
                    <div class="response" id="addSongResponse"></div>
                </div>

                <!-- Remove Song -->
                <div class="api-group">
                    <h3>DELETE /api/concert/:roomId/songs/:songNum - Remove Song (JWT Required, Studio Only)</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Room ID</label>
                            <input type="text" id="removeSongRoomId" placeholder="concert_1234567890_abc123">
                        </div>
                        <div class="input-group">
                            <label>Song Number</label>
                            <input type="number" id="removeSongNum" placeholder="1">
                        </div>
                    </div>
                    <button class="btn-danger" onclick="removeSong()">Remove Song</button>
                    <div class="response" id="removeSongResponse"></div>
                </div>

                <!-- Change Song -->
                <div class="api-group">
                    <h3>POST /api/concert/:roomId/songs/change - Change Current Song (JWT Required, Studio Only)</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Room ID</label>
                            <input type="text" id="changeSongRoomId" placeholder="concert_1234567890_abc123">
                        </div>
                        <div class="input-group">
                            <label>Song Number</label>
                            <input type="number" id="changeSongNum" placeholder="2">
                        </div>
                    </div>
                    <button class="btn-warning" onclick="changeSong()">Change Song</button>
                    <div class="response" id="changeSongResponse"></div>
                </div>

                <!-- Add Accessory -->
                <div class="api-group">
                    <h3>POST /api/concert/:roomId/accessories/add - Add Accessory (JWT Required, Studio Only)</h3>
                    <div class="input-group">
                        <label>Room ID</label>
                        <input type="text" id="addAccessoryRoomId" placeholder="concert_1234567890_abc123">
                    </div>
                    <div class="input-group">
                        <label>Socket Name</label>
                        <input type="text" id="addAccessorySocketName" placeholder="head_socket">
                    </div>
                    <div class="flex">
                        <div class="input-group">
                            <label>Location X</label>
                            <input type="number" id="addAccessoryLocationX" placeholder="0" step="0.01">
                        </div>
                        <div class="input-group">
                            <label>Location Y</label>
                            <input type="number" id="addAccessoryLocationY" placeholder="0" step="0.01">
                        </div>
                        <div class="input-group">
                            <label>Location Z</label>
                            <input type="number" id="addAccessoryLocationZ" placeholder="10" step="0.01">
                        </div>
                    </div>
                    <div class="flex">
                        <div class="input-group">
                            <label>Rotation Pitch</label>
                            <input type="number" id="addAccessoryRotationPitch" placeholder="0" step="0.01">
                        </div>
                        <div class="input-group">
                            <label>Rotation Yaw</label>
                            <input type="number" id="addAccessoryRotationYaw" placeholder="0" step="0.01">
                        </div>
                        <div class="input-group">
                            <label>Rotation Roll</label>
                            <input type="number" id="addAccessoryRotationRoll" placeholder="0" step="0.01">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Model URL</label>
                        <input type="text" id="addAccessoryModelUrl" placeholder="/models/hat.glb">
                    </div>
                    <button class="btn-primary" onclick="addAccessory()">Add Accessory</button>
                    <div class="response" id="addAccessoryResponse"></div>
                </div>

                <!-- Remove Accessory -->
                <div class="api-group">
                    <h3>DELETE /api/concert/:roomId/accessories/:index - Remove Accessory (JWT Required, Studio Only)</h3>
                    <div class="flex">
                        <div class="input-group">
                            <label>Room ID</label>
                            <input type="text" id="removeAccessoryRoomId" placeholder="concert_1234567890_abc123">
                        </div>
                        <div class="input-group">
                            <label>Accessory Index</label>
                            <input type="number" id="removeAccessoryIndex" placeholder="0">
                        </div>
                    </div>
                    <button class="btn-danger" onclick="removeAccessory()">Remove Accessory</button>
                    <div class="response" id="removeAccessoryResponse"></div>
                </div>

                <!-- Update Accessories -->
                <div class="api-group">
                    <h3>PUT /api/concert/:roomId/accessories - Replace All Accessories (JWT Required, Studio Only)</h3>
                    <div class="input-group">
                        <label>Room ID</label>
                        <input type="text" id="updateAccessoriesRoomId" placeholder="concert_1234567890_abc123">
                    </div>
                    <div class="input-group">
                        <label>Accessories JSON Array</label>
                        <textarea id="updateAccessoriesJson" placeholder='[{"socketName":"head_socket","relativeLocation":{"x":0,"y":0,"z":10},"relativeRotation":{"pitch":0,"yaw":0,"roll":0},"modelUrl":"/models/hat.glb"}]'></textarea>
                        <div class="example-box" onclick="copyToInput('updateAccessoriesJson', '[{&quot;socketName&quot;:&quot;head_socket&quot;,&quot;relativeLocation&quot;:{&quot;x&quot;:0,&quot;y&quot;:0,&quot;z&quot;:10},&quot;relativeRotation&quot;:{&quot;pitch&quot;:0,&quot;yaw&quot;:0,&quot;roll&quot;:0},&quot;modelUrl&quot;:&quot;/models/hat.glb&quot;}]', this)">[{"socketName":"head_socket","relativeLocation":{"x":0,"y":0,"z":10},"relativeRotation":{"pitch":0,"yaw":0,"roll":0},"modelUrl":"/models/hat.glb"}]</div>
                    </div>
                    <button class="btn-warning" onclick="updateAccessories()">Update All Accessories</button>
                    <div class="response" id="updateAccessoriesResponse"></div>
                </div>
            </div>
        </div>
    
        <!-- ÌÉ≠ ÏΩòÌÖêÏ∏†: Ïò§ÎîîÏñ∏Ïä§ ÏΩòÏÑúÌä∏ ÏÑ∏ÏÖò -->
        <div id="tab-audience-concert" class="tab-content">
            <div class="section">
                <h2>Ïò§ÎîîÏñ∏Ïä§ ÏΩòÏÑúÌä∏ ÏÑ∏ÏÖò API</h2>

                <!-- List Concerts -->
                <div class="api-group">
                    <h3>GET /api/concert/list - List Active Concerts (JWT Required)</h3>
                    <button class="btn-primary" onclick="listConcerts()">List Concerts</button>
                    <div class="response" id="listConcertsResponse"></div>
                </div>

                <!-- Get Concert Info -->
                <div class="api-group">
                    <h3>GET /api/concert/:roomId/info - Get Concert Info (JWT Required)</h3>
                    <div class="input-group">
                        <label>Room ID</label>
                        <input type="text" id="infoRoomId" placeholder="concert_1234567890_abc123">
                    </div>
                    <button class="btn-primary" onclick="getConcertInfo()">Get Concert Info</button>
                    <div class="response" id="concertInfoResponse"></div>
                </div>

                <!-- Get Current Song -->
                <div class="api-group">
                    <h3>GET /api/concert/:roomId/current-song - Get Current Song (JWT Required, Audience)</h3>
                    <div class="input-group">
                        <label>Room ID</label>
                        <input type="text" id="currentSongRoomId" placeholder="concert_1234567890_abc123">
                    </div>
                    <button class="btn-secondary" onclick="getCurrentSong()">Get Current Song</button>
                    <div class="response" id="currentSongResponse"></div>
                </div>

            </div>
        </div>
    </div>

    <script>
        let jwtToken = localStorage.getItem('mve_jwt_token') || '';

        // Ï¥àÍ∏∞Ìôî - Ïø†ÌÇ§ÎêòÏñ¥ ÏûàÎäî ÌÜ†ÌÅ∞ÏùÑ Î°úÎìúÌïòÍ≥† ÏûàÎã§?
        document.addEventListener('DOMContentLoaded', () => {
            updateTokenDisplay();
        });

        // ÌÉ≠ Ïä§ÏúÑÏπ≠
        function switchTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tc => tc.classList.remove('active'));

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(t => t.classList.remove('active'));

            // Show selected tab content
            document.getElementById(`tab-${tabName}`).classList.add('active');

            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        function updateTokenDisplay() {
            const display = document.getElementById('currentToken');
            if (jwtToken) {
                display.textContent = jwtToken;
            } else {
                display.textContent = 'No token';
            }
        }

        function getLoginServerUrl() {
            return document.getElementById('loginServerUrl').value;
        }

        function getResourceServerUrl() {
            return document.getElementById('resourceServerUrl').value;
        }

        function getAuthHeaders() {
            return jwtToken ? { 'Authorization': `Bearer ${jwtToken}` } : {};
        }

        async function apiCall(url, options = {}) {
            const startTime = Date.now();
            try {
                const response = await fetch(url, {
                    ...options,
                    headers: {
                        'Content-Type': 'application/json',
                        ...getAuthHeaders(),
                        ...options.headers
                    }
                });
                const data = await response.json();
                const duration = Date.now() - startTime;
                return {
                    status: response.status,
                    statusText: response.statusText,
                    duration: `${duration}ms`,
                    data
                };
            } catch (error) {
                const duration = Date.now() - startTime;
                return {
                    status: 'ERROR',
                    duration: `${duration}ms`,
                    error: error.message
                };
            }
        }

        function displayResponse(elementId, response) {
            document.getElementById(elementId).textContent = JSON.stringify(response, null, 2);
        }

        // Î°úÍ∑∏Ïù∏ ÏÑúÎ≤Ñ Ìó¨Ïä§ Ï≤¥ÌÅ¨ API
        async function testLoginHealth() {
            const response = await apiCall(`${getLoginServerUrl()}/health/login`);
            displayResponse('healthResponse', response);
        }

        // Î°úÍ∑∏Ïù∏ ÏÑúÎ≤Ñ Ïù∏Ï¶ù API
        async function checkEmail() {
            const email = document.getElementById('checkEmail').value;
            const response = await apiCall(`${getLoginServerUrl()}/api/auth/check-email`, {
                method: 'POST',
                body: JSON.stringify({ email })
            });
            displayResponse('checkEmailResponse', response);

            // ÏÇ¨Ïö©Ïûê ÏπúÌôîÏ†Å Î©îÏãúÏßÄ ÌëúÏãú
            if (response.data) {
                if (response.data.success) {
                    console.log('‚úì Ïù¥Î©îÏùº ÏÇ¨Ïö© Í∞ÄÎä•');
                } else if (response.data.error === 'EMAIL_ALREADY_EXISTS') {
                    console.log('‚ö† Ïù¥Î©îÏùºÏù¥ Ïù¥ÎØ∏ ÏÇ¨Ïö© Ï§ëÏûÖÎãàÎã§');
                }
            }
        }

        async function sendVerification() {
            const email = document.getElementById('verifyEmail').value;
            const response = await apiCall(`${getLoginServerUrl()}/api/auth/send-verification`, {
                method: 'POST',
                body: JSON.stringify({ email })
            });
            displayResponse('sendVerificationResponse', response);
        }

        async function verifyCode() {
            const email = document.getElementById('verifyCodeEmail').value;
            const code = document.getElementById('verifyCode').value;
            const response = await apiCall(`${getLoginServerUrl()}/api/auth/verify-code`, {
                method: 'POST',
                body: JSON.stringify({ email, code })
            });
            displayResponse('verifyCodeResponse', response);
        }

        async function signup() {
            const email = document.getElementById('signupEmail').value;
            const code = document.getElementById('signupCode').value;
            const password = document.getElementById('signupPassword').value;
            const response = await apiCall(`${getLoginServerUrl()}/api/auth/signup`, {
                method: 'POST',
                body: JSON.stringify({ email, code, password })
            });
            displayResponse('signupResponse', response);
        }

        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const response = await apiCall(`${getLoginServerUrl()}/api/auth/login`, {
                method: 'POST',
                body: JSON.stringify({ email, password })
            });
            displayResponse('loginResponse', response);

            // Save token if login successful
            if (response.data && response.data.token) {
                jwtToken = response.data.token;
                localStorage.setItem('mve_jwt_token', jwtToken);
                updateTokenDisplay();
            }
        }

        async function getProfile() {
            const response = await apiCall(`${getLoginServerUrl()}/api/auth/profile`);
            displayResponse('profileResponse', response);
        }

        async function logout() {
            const response = await apiCall(`${getLoginServerUrl()}/api/auth/logout`, {
                method: 'POST'
            });
            displayResponse('logoutResponse', response);

            if (response.data && response.data.success) {
                jwtToken = '';
                localStorage.removeItem('mve_jwt_token');
                updateTokenDisplay();
            }
        }

        async function withdraw() {
            const password = document.getElementById('withdrawPassword').value;
            if (!password) {
                displayResponse('withdrawResponse', { error: 'Password is required' });
                return;
            }

            if (!confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
                return;
            }

            const response = await apiCall(`${getLoginServerUrl()}/api/auth/withdraw`, {
                method: 'DELETE',
                body: JSON.stringify({ password })
            });
            displayResponse('withdrawResponse', response);

            if (response.data && response.data.success) {
                jwtToken = '';
                localStorage.removeItem('mve_jwt_token');
                updateTokenDisplay();
            }
        }

        // Î¶¨ÏÜåÏä§ ÏÑúÎ≤Ñ Ìó¨Ïä§ Ï≤¥ÌÅ¨ API
        async function testResourceHealth() {
            const response = await apiCall(`${getResourceServerUrl()}/health/resource`);
            displayResponse('resourceHealthResponse', response);
        }

        // Î¶¨ÏÜåÏä§ ÏÑúÎ≤Ñ ÏùåÏõê Ïä§Ìä∏Î¶º API
        async function getAudioList() {
            const response = await apiCall(`${getResourceServerUrl()}/api/audio/list`);
            displayResponse('audioListResponse', response);
        }

        async function getAudioInfo() {
            const id = document.getElementById('audioId').value;
            const response = await apiCall(`${getResourceServerUrl()}/api/audio/${id}`);
            displayResponse('audioInfoResponse', response);
        }

        async function searchAudio() {
            const query = document.getElementById('audioSearchQuery').value;
            const response = await apiCall(`${getResourceServerUrl()}/api/audio/search/${encodeURIComponent(query)}`);
            displayResponse('audioSearchResponse', response);
        }

        async function uploadAudio() {
            const title = document.getElementById('uploadTitle').value;
            const artist = document.getElementById('uploadArtist').value;
            const fileInput = document.getElementById('uploadAudioFile');

            if (!fileInput.files[0]) {
                displayResponse('uploadAudioResponse', { error: 'No file selected' });
                return;
            }

            if (!title) {
                displayResponse('uploadAudioResponse', { error: 'Title is required' });
                return;
            }

            const formData = new FormData();
            formData.append('audio', fileInput.files[0]);
            formData.append('title', title);
            if (artist) formData.append('artist', artist);

            const startTime = Date.now();
            try {
                const response = await fetch(`${getResourceServerUrl()}/api/audio/upload`, {
                    method: 'POST',
                    headers: {
                        ...getAuthHeaders()
                    },
                    body: formData
                });
                const data = await response.json();
                const duration = Date.now() - startTime;
                displayResponse('uploadAudioResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    duration: `${duration}ms`,
                    data
                });
            } catch (error) {
                const duration = Date.now() - startTime;
                displayResponse('uploadAudioResponse', {
                    status: 'ERROR',
                    duration: `${duration}ms`,
                    error: error.message
                });
            }
        }

        async function streamAudio() {
            const id = document.getElementById('targetAudioId').value;
            const startTime = Date.now();
            try {
                const response = await fetch(`${getResourceServerUrl()}/api/audio/stream/${id}`, {
                    headers: getAuthHeaders()
                });
                const duration = Date.now() - startTime;
                const contentType = response.headers.get('content-type');

                // S3 Î™®Îìú: JSON ÏùëÎãµ (presigned URL)
                if (contentType && contentType.includes('application/json')) {
                    const data = await response.json();
                    displayResponse('getAudioUrlResponse', {
                        status: response.status,
                        statusText: response.statusText,
                        duration: `${duration}ms`,
                        data
                    });
                } else {
                    // Î°úÏª¨ Î™®Îìú: Î∞îÏù¥ÎÑàÎ¶¨ Ïä§Ìä∏Î¶¨Î∞ç
                    displayResponse('getAudioUrlResponse', {
                        status: response.status,
                        statusText: response.statusText,
                        duration: `${duration}ms`,
                        message: 'Local streaming mode - binary data returned',
                        contentType: contentType,
                        contentLength: response.headers.get('content-length'),
                        streamUrl: `${getResourceServerUrl()}/api/audio/stream/${id}`
                    });
                }
            } catch (error) {
                const duration = Date.now() - startTime;
                displayResponse('getAudioUrlResponse', {
                    status: 'ERROR',
                    duration: `${duration}ms`,
                    error: error.message
                });
            }
        }

        async function playAudio() {
            const startTime = Date.now();

            let audioUrl = document.getElementById('targetAudioUrl').value;
            const player = document.getElementById('audioPlayer');

            if (audioUrl) {
                try {
                    // ÏÉÅÎåÄ Í≤ΩÎ°úÏù∏ Í≤ΩÏö∞ (Î°úÏª¨) - fetchÎ°ú blob Í∞ÄÏ†∏ÏôÄÏÑú Ïû¨ÏÉù
                    if (audioUrl.startsWith('/')) {
                        const audioResponse = await fetch(`${getResourceServer()}${audioUrl}`, {
                            headers: { 'Authorization': `Bearer ${token}` }
                        });
                        const blob = await audioResponse.blob();
                        audioUrl = URL.createObjectURL(blob);
                    }

                    player.src = audioUrl;
                    player.style.display = 'block';
                    await player.play();

                    const duration = Date.now() - startTime;
                    displayResponse('streamAudioResponse', {
                        status: `Ïû¨ÏÉù Ï§ë: ${audioUrl}`,
                        duration: `${duration}ms`
                    });
                } catch (error) {
                    const duration = Date.now() - startTime;
                    displayResponse('streamAudioResponse', {
                        status: 'ERROR',
                        duration: `${duration}ms`,
                        error: error.message
                    });
                }
            } else {
                const duration = Date.now() - startTime;
                displayResponse('streamAudioResponse', {
                    status: 'ERROR',
                    duration: `${duration}ms`,
                    error: 'URLÏù¥ ÏûÖÎ†•ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§'
                });
            }
        }

        // AI 3D Î™®Îç∏ ÏÉùÏÑ± API
        let pollingInterval = null;

        async function generateModel() {
            const fileInput = document.getElementById('generateImageFile');
            const prompt = document.getElementById('generatePrompt').value;

            if (!fileInput.files[0]) {
                displayResponse('generateModelResponse', { error: 'No PNG file selected' });
                return;
            }

            if (!prompt) {
                displayResponse('generateModelResponse', { error: 'Prompt is required' });
                return;
            }

            // Check if file is PNG
            const fileName = fileInput.files[0].name.toLowerCase();
            if (!fileName.endsWith('.png')) {
                displayResponse('generateModelResponse', { error: 'Only PNG files are allowed' });
                return;
            }

            const formData = new FormData();
            formData.append('image', fileInput.files[0]);
            formData.append('prompt', prompt);

            const startTime = Date.now();
            try {
                const response = await fetch(`${getResourceServerUrl()}/api/models/generate`, {
                    method: 'POST',
                    headers: {
                        ...getAuthHeaders()
                    },
                    body: formData
                });
                const data = await response.json();
                const duration = Date.now() - startTime;
                displayResponse('generateModelResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    duration: `${duration}ms`,
                    data
                });

                // Auto-fill job_id if successful
                if (data.job_id) {
                    document.getElementById('jobId').value = data.job_id;
                }
            } catch (error) {
                const duration = Date.now() - startTime;
                displayResponse('generateModelResponse', {
                    status: 'ERROR',
                    duration: `${duration}ms`,
                    error: error.message
                });
            }
        }

        async function checkJobStatus() {
            const jobId = document.getElementById('jobId').value;

            if (!jobId) {
                displayResponse('jobStatusResponse', { error: 'Job ID is required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/models/jobs/${jobId}`);
            displayResponse('jobStatusResponse', response);
        }

        function startPolling() {
            const jobId = document.getElementById('jobId').value;

            if (!jobId) {
                displayResponse('jobStatusResponse', { error: 'Job ID is required for polling' });
                return;
            }

            // Stop existing polling
            stopPolling();

            // Start new polling
            displayResponse('jobStatusResponse', { status: 'Polling started (every 3 seconds)...' });

            pollingInterval = setInterval(async () => {
                const response = await apiCall(`${getResourceServerUrl()}/api/models/jobs/${jobId}`);
                displayResponse('jobStatusResponse', response);

                // Stop polling if completed or failed
                if (response.data && response.data.job) {
                    if (response.data.job.status === 'completed' || response.data.job.status === 'failed') {
                        stopPolling();
                        displayResponse('jobStatusResponse', {
                            ...response,
                            message: `Polling stopped. Job ${response.data.job.status}.`
                        });
                    }
                }
            }, 3000);
        }

        function stopPolling() {
            if (pollingInterval) {
                clearInterval(pollingInterval);
                pollingInterval = null;
            }
        }

        async function getAIModelInfo() {
            const id = document.getElementById('aiModelId').value;
            const response = await apiCall(`${getResourceServerUrl()}/api/models/${id}`);
            displayResponse('aiModelInfoResponse', response);
        }

        async function uploadModel() {
            const modelName = document.getElementById('uploadModelName').value;
            const modelFileInput = document.getElementById('uploadModelFile');
            const thumbnailFileInput = document.getElementById('uploadModelThumbnail');

            if (!modelFileInput.files[0]) {
                displayResponse('uploadModelResponse', { error: 'Model file is required' });
                return;
            }

            const formData = new FormData();
            formData.append('model', modelFileInput.files[0]);

            if (modelName) {
                formData.append('model_name', modelName);
            }

            if (thumbnailFileInput.files[0]) {
                formData.append('thumbnail', thumbnailFileInput.files[0]);
            }

            const startTime = Date.now();
            try {
                const response = await fetch(`${getResourceServerUrl()}/api/models/upload`, {
                    method: 'POST',
                    headers: {
                        ...getAuthHeaders()
                    },
                    body: formData
                });
                const data = await response.json();
                const duration = Date.now() - startTime;
                displayResponse('uploadModelResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    duration: `${duration}ms`,
                    data
                });
            } catch (error) {
                const duration = Date.now() - startTime;
                displayResponse('uploadModelResponse', {
                    status: 'ERROR',
                    duration: `${duration}ms`,
                    error: error.message
                });
            }
        }

        async function downloadModel() {
            const id = document.getElementById('downloadModelId').value;

            if (!id) {
                displayResponse('downloadModelResponse', { error: 'Model ID is required' });
                return;
            }

            const url = `${getResourceServerUrl()}/api/models/${id}/download`;

            displayResponse('downloadModelResponse', {
                message: 'Opening download URL...',
                url: url,
                note: 'File should download automatically. If not, copy the URL above and paste it in a new tab with Authorization header.'
            });

            // Open in new window with token
            window.open(url, '_blank');
        }

        async function deleteAIModel() {
            const id = document.getElementById('deleteAIModelId').value;
            if (!id) {
                displayResponse('deleteAIModelResponse', { error: 'Model ID is required' });
                return;
            }

            if (confirm(`Are you sure you want to delete model ${id}?`)) {
                const response = await apiCall(`${getResourceServerUrl()}/api/models/${id}`, {
                    method: 'DELETE'
                });
                displayResponse('deleteAIModelResponse', response);
            }
        }

        async function devUploadModel() {
            const userId = document.getElementById('devUserId').value;
            const modelName = document.getElementById('devModelName').value;
            const modelFileInput = document.getElementById('devModelFile');
            const thumbnailFileInput = document.getElementById('devThumbnailFile');

            if (!modelFileInput.files[0]) {
                displayResponse('devUploadResponse', { error: 'Model file is required' });
                return;
            }

            const formData = new FormData();
            formData.append('model', modelFileInput.files[0]);

            if (userId) {
                formData.append('user_id', userId);
            }

            if (modelName) {
                formData.append('model_name', modelName);
            }

            if (thumbnailFileInput.files[0]) {
                formData.append('thumbnail', thumbnailFileInput.files[0]);
            }

            const startTime = Date.now();
            try {
                const response = await fetch(`${getResourceServerUrl()}/api/models/dev/upload-from-ai`, {
                    method: 'POST',
                    // NO AUTH HEADERS - This is a dev-only endpoint
                    body: formData
                });
                const data = await response.json();
                const duration = Date.now() - startTime;
                displayResponse('devUploadResponse', {
                    status: response.status,
                    statusText: response.statusText,
                    duration: `${duration}ms`,
                    data
                });
            } catch (error) {
                const duration = Date.now() - startTime;
                displayResponse('devUploadResponse', {
                    status: 'ERROR',
                    duration: `${duration}ms`,
                    error: error.message
                });
            }
        }

        // Î¶¨ÏÜåÏä§ ÏÑúÎ≤Ñ Î™®Îç∏ ÏÉùÏÑ± API
        async function getModelList() {
            const response = await apiCall(`${getResourceServerUrl()}/api/models/list`);
            displayResponse('modelListResponse', response);
        }

        async function getModelInfo() {
            const id = document.getElementById('modelId').value;
            const response = await apiCall(`${getResourceServerUrl()}/api/models/${id}`);
            displayResponse('modelInfoResponse', response);
        }

        async function registerModel() {
            const data = document.getElementById('registerModelData').value;
            try {
                const response = await apiCall(`${getResourceServerUrl()}/api/models/register`, {
                    method: 'POST',
                    body: data
                });
                displayResponse('registerModelResponse', response);
            } catch (e) {
                displayResponse('registerModelResponse', { error: 'Invalid JSON' });
            }
        }

        async function updateModel() {
            const id = document.getElementById('updateModelId').value;
            const data = document.getElementById('updateModelData').value;
            try {
                const response = await apiCall(`${getResourceServerUrl()}/api/models/${id}`, {
                    method: 'PUT',
                    body: data
                });
                displayResponse('updateModelResponse', response);
            } catch (e) {
                displayResponse('updateModelResponse', { error: 'Invalid JSON' });
            }
        }

        async function deleteModel() {
            const id = document.getElementById('deleteModelId').value;
            if (confirm(`Are you sure you want to delete model ${id}?`)) {
                const response = await apiCall(`${getResourceServerUrl()}/api/models/${id}`, {
                    method: 'DELETE'
                });
                displayResponse('deleteModelResponse', response);
            }
        }

        // Î¶¨ÏÜåÏä§ ÏÑúÎ≤Ñ ÏΩòÏÑúÌä∏ ÏÑ∏ÏÖò API
        async function createConcert() {
            const concertName = document.getElementById('concertName').value;
            const maxAudience = document.getElementById('concertMaxAudience').value;
            const songsJson = document.getElementById('concertSongsJson').value;
            const accessoriesJson = document.getElementById('concertAccessoriesJson').value;

            if (!concertName) {
                displayResponse('createConcertResponse', { error: 'concertName is required' });
                return;
            }

            const body = {
                concertName
            };

            if (maxAudience) {
                body.maxAudience = parseInt(maxAudience);
            }

            if (songsJson) {
                try {
                    body.songs = JSON.parse(songsJson);
                } catch (e) {
                    displayResponse('createConcertResponse', { error: 'Invalid JSON in songs field' });
                    return;
                }
            }

            if (accessoriesJson) {
                try {
                    body.accessories = JSON.parse(accessoriesJson);
                } catch (e) {
                    displayResponse('createConcertResponse', { error: 'Invalid JSON in accessories field' });
                    return;
                }
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/create`, {
                method: 'POST',
                body: JSON.stringify(body)
            });
            displayResponse('createConcertResponse', response);
        }

        async function listConcerts() {
            const response = await apiCall(`${getResourceServerUrl()}/api/concert/list`);
            displayResponse('listConcertsResponse', response);
        }

        async function joinConcert() {
            const roomId = document.getElementById('joinRoomIdStudio').value;
            const clientId = document.getElementById('joinClientId').value;

            if (!roomId || !clientId) {
                displayResponse('joinConcertResponse', { error: 'Room ID is required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/join`, {
                method: 'POST',
                body: JSON.stringify({
                    clientId: parseInt(clientId)
                })
            });
            displayResponse('joinConcertResponse', response);
        }

        async function leaveConcert() {
            const roomId = document.getElementById('leaveRoomId').value;
            const clientId = document.getElementById('leaveClientId').value;

            if (!roomId || !clientId) {
                displayResponse('leaveConcertResponse', { error: 'Room ID and Client ID are required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/leave`, {
                method: 'POST',
                body: JSON.stringify({ clientId: parseInt(clientId) })
            });
            displayResponse('leaveConcertResponse', response);
        }

        async function getConcertInfo() {
            const roomId = document.getElementById('infoRoomId').value;
            if (!roomId) {
                displayResponse('concertInfoResponse', { error: 'Room ID is required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/info`);
            displayResponse('concertInfoResponse', response);
        }

        async function updateListenServer() {
            const roomId = document.getElementById('listenServerRoomId').value;
            const localIP = document.getElementById('listenServerLocalIP').value;
            const port = document.getElementById('listenServerPort').value;
            const publicIP = document.getElementById('listenServerPublicIP').value;
            const publicPort = document.getElementById('listenServerPublicPort').value;

            if (!roomId || !localIP || !port) {
                displayResponse('updateListenServerResponse', { error: 'Room ID, Local IP, and Port are required' });
                return;
            }

            const body = {
                localIP,
                port: parseInt(port)
            };

            if (publicIP) body.publicIP = publicIP;
            if (publicPort) body.publicPort = parseInt(publicPort);

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/listen-server`, {
                method: 'POST',
                body: JSON.stringify(body)
            });
            displayResponse('updateListenServerResponse', response);
        }

        async function toggleConcertOpen(isOpen) 
        {
            // ÏΩòÏÑúÌä∏Î•º Ïó¥Í≥† Ïã∂ÏùÄ Î£∏Ïùò Id
            const roomId = document.getElementById('toggleConcertOpenRoomId').value;
            if (!roomId) {
                displayResponse('joinConcertResponse', { error: 'Room ID is required' });
                return;
            }

            // ÏóÖÎç∞Ïù¥Ìä∏Ìï† Î£∏Ïùò ÏÉÅÌÉú
            const body = {
                isOpen
            }

            // API Ìò∏Ï∂ú Î∞è Î¶¨Ïä§Ìè∞Ïä§ ÌöçÎìù
            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/toggle-open`, {
                method: 'POST',
                body: JSON.stringify(body)
            });

            //Î¶¨Ïä§Ìè∞Ïä§ Ï∂úÎ†•
            displayResponse('toggleConcertOpenResponse', response);
        }

        // Î¶¨ÏÜåÏä§ ÏÑúÎ≤Ñ ÏΩòÏÑúÌä∏ Í≥° API
        async function addSong() {
            const roomId = document.getElementById('addSongRoomId').value;
            const songNum = document.getElementById('addSongNum').value;
            const audioId = document.getElementById('addSongAudioId').value;
            const streamUrl = document.getElementById('addSongStreamUrl').value;
            const stageDirectionId = document.getElementById('addSongStageDirectionId').value;

            if (!roomId || !songNum || !audioId || !streamUrl || !stageDirectionId) {
                displayResponse('addSongResponse', { error: 'All fields are required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/songs/add`, {
                method: 'POST',
                body: JSON.stringify({
                    songNum: parseInt(songNum),
                    audioId: parseInt(audioId),
                    streamUrl,
                    stageDirectionId: parseInt(stageDirectionId)
                })
            });
            displayResponse('addSongResponse', response);
        }

        async function removeSong() {
            const roomId = document.getElementById('removeSongRoomId').value;
            const songNum = document.getElementById('removeSongNum').value;

            if (!roomId || !songNum) {
                displayResponse('removeSongResponse', { error: 'Room ID and Song Number are required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/songs/${songNum}`, {
                method: 'DELETE'
            });
            displayResponse('removeSongResponse', response);
        }

        async function changeSong() {
            const roomId = document.getElementById('changeSongRoomId').value;
            const songNum = document.getElementById('changeSongNum').value;

            if (!roomId || !songNum) {
                displayResponse('changeSongResponse', { error: 'Room ID and Song Number are required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/songs/change`, {
                method: 'POST',
                body: JSON.stringify({
                    songNum: parseInt(songNum)
                })
            });
            displayResponse('changeSongResponse', response);
        }

        async function getCurrentSong() {
            const roomId = document.getElementById('currentSongRoomId').value;

            if (!roomId) {
                displayResponse('currentSongResponse', { error: 'Room ID is required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/current-song`);
            displayResponse('currentSongResponse', response);
        }

        // Î¶¨ÏÜåÏä§ ÏÑúÎ≤Ñ ÏóëÏÑ∏ÏÑúÎ¶¨ Í¥ÄÎ¶¨ API
        async function addAccessory() {
            const roomId = document.getElementById('addAccessoryRoomId').value;
            const socketName = document.getElementById('addAccessorySocketName').value;
            const locationX = document.getElementById('addAccessoryLocationX').value;
            const locationY = document.getElementById('addAccessoryLocationY').value;
            const locationZ = document.getElementById('addAccessoryLocationZ').value;
            const rotationPitch = document.getElementById('addAccessoryRotationPitch').value;
            const rotationYaw = document.getElementById('addAccessoryRotationYaw').value;
            const rotationRoll = document.getElementById('addAccessoryRotationRoll').value;
            const modelUrl = document.getElementById('addAccessoryModelUrl').value;

            if (!roomId || !socketName || !modelUrl) {
                displayResponse('addAccessoryResponse', { error: 'Room ID, Socket Name, and Model URL are required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/accessories/add`, {
                method: 'POST',
                body: JSON.stringify({
                    socketName,
                    relativeLocation: {
                        x: parseFloat(locationX) || 0,
                        y: parseFloat(locationY) || 0,
                        z: parseFloat(locationZ) || 0
                    },
                    relativeRotation: {
                        pitch: parseFloat(rotationPitch) || 0,
                        yaw: parseFloat(rotationYaw) || 0,
                        roll: parseFloat(rotationRoll) || 0
                    },
                    modelUrl
                })
            });
            displayResponse('addAccessoryResponse', response);
        }

        async function removeAccessory() {
            const roomId = document.getElementById('removeAccessoryRoomId').value;
            const index = document.getElementById('removeAccessoryIndex').value;

            if (!roomId || index === '') {
                displayResponse('removeAccessoryResponse', { error: 'Room ID and Index are required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/accessories/${index}`, {
                method: 'DELETE'
            });
            displayResponse('removeAccessoryResponse', response);
        }

        async function updateAccessories() {
            const roomId = document.getElementById('updateAccessoriesRoomId').value;
            const accessoriesJson = document.getElementById('updateAccessoriesJson').value;

            if (!roomId) {
                displayResponse('updateAccessoriesResponse', { error: 'Room ID is required' });
                return;
            }

            let accessories;
            try {
                accessories = JSON.parse(accessoriesJson);
                if (!Array.isArray(accessories)) {
                    displayResponse('updateAccessoriesResponse', { error: 'Accessories must be a JSON array' });
                    return;
                }
            } catch (e) {
                displayResponse('updateAccessoriesResponse', { error: 'Invalid JSON in accessories field' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/concert/${roomId}/accessories`, {
                method: 'PUT',
                body: JSON.stringify({ accessories })
            });
            displayResponse('updateAccessoriesResponse', response);
        }

        // Î¶¨ÏÜåÏä§ ÏÑúÎ≤Ñ ÏóëÏÑ∏ÏÑúÎ¶¨ ÌîÑÎ¶¨ÏÖã API
        async function savePreset() {
            const presetName = document.getElementById('presetName').value;
            const description = document.getElementById('presetDescription').value;
            const accessoriesJson = document.getElementById('presetAccessoriesJson').value;
            const isPublic = document.getElementById('presetIsPublic').checked;

            if (!presetName || !accessoriesJson) {
                displayResponse('savePresetResponse', { error: 'Preset Name and Accessories are required' });
                return;
            }

            let accessories;
            try {
                accessories = JSON.parse(accessoriesJson);
                if (!Array.isArray(accessories)) {
                    displayResponse('savePresetResponse', { error: 'Accessories must be a JSON array' });
                    return;
                }
            } catch (e) {
                displayResponse('savePresetResponse', { error: 'Invalid JSON in accessories field' });
                return;
            }

            const body = {
                presetName,
                accessories,
                isPublic
            };

            if (description) {
                body.description = description;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/accessory-presets/save`, {
                method: 'POST',
                body: JSON.stringify(body)
            });
            displayResponse('savePresetResponse', response);
        }

        async function listPresets() {
            const includePublic = document.getElementById('includePublicPresets').checked;
            const url = `${getResourceServerUrl()}/api/accessory-presets/list${includePublic ? '?includePublic=true' : ''}`;

            const response = await apiCall(url);
            displayResponse('listPresetsResponse', response);
        }

        async function getPreset() {
            const id = document.getElementById('getPresetId').value;

            if (!id) {
                displayResponse('getPresetResponse', { error: 'Preset ID is required' });
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/accessory-presets/${id}`);
            displayResponse('getPresetResponse', response);
        }

        async function updatePreset() {
            const id = document.getElementById('updatePresetId').value;
            const presetName = document.getElementById('updatePresetName').value;
            const description = document.getElementById('updatePresetDescription').value;
            const accessoriesJson = document.getElementById('updatePresetAccessoriesJson').value;
            const isPublic = document.getElementById('updatePresetIsPublic').checked;

            if (!id) {
                displayResponse('updatePresetResponse', { error: 'Preset ID is required' });
                return;
            }

            const body = {};

            if (presetName) body.presetName = presetName;
            if (description) body.description = description;
            if (isPublic !== undefined) body.isPublic = isPublic;

            if (accessoriesJson) {
                try {
                    const accessories = JSON.parse(accessoriesJson);
                    if (!Array.isArray(accessories)) {
                        displayResponse('updatePresetResponse', { error: 'Accessories must be a JSON array' });
                        return;
                    }
                    body.accessories = accessories;
                } catch (e) {
                    displayResponse('updatePresetResponse', { error: 'Invalid JSON in accessories field' });
                    return;
                }
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/accessory-presets/${id}`, {
                method: 'PUT',
                body: JSON.stringify(body)
            });
            displayResponse('updatePresetResponse', response);
        }

        async function deletePreset() {
            const id = document.getElementById('deletePresetId').value;

            if (!id) {
                displayResponse('deletePresetResponse', { error: 'Preset ID is required' });
                return;
            }

            if (!confirm(`Are you sure you want to delete preset ${id}?`)) {
                return;
            }

            const response = await apiCall(`${getResourceServerUrl()}/api/accessory-presets/${id}`, {
                method: 'DELETE'
            });
            displayResponse('deletePresetResponse', response);
        }

        // ÏûÖÎ†• ÌïÑÎìúÏóê ÏòàÏ†úÎ•º Î≥µÏÇ¨
        function copyToInput(inputId, jsonText, element) {
            const textarea = document.getElementById(inputId);
            // HTML entitiesÎ•º Ïã§Ï†ú Î¨∏ÏûêÎ°ú Î≥ÄÌôò
            const decodedText = jsonText.replace(/&quot;/g, '"');
            textarea.value = decodedText;

            // Î≥µÏÇ¨ ÏôÑÎ£å Ïï†ÎãàÎ©îÏù¥ÏÖò
            element.classList.add('copied');
            setTimeout(() => {
                element.classList.remove('copied');
            }, 2000);
        }
    </script>
</body>
</html>
